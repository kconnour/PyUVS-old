# Built-in imports
from datetime import date, timedelta, datetime


def format_date(some_date):
    """ Format a date to match the IUVS "standard"

    Parameters
    ----------
    some_date: datetime
        Some date that you want formatted

    Returns
    -------
    some_date: datetime
        A formatted date

    Examples
    --------
    >>> date.today()
    2020-07-15
    >>> mi.format_date(date.today())
    Jul 15
    """
    return some_date.strftime("%b %d")


def get_science_week(some_date):
    """ Get the science week number for a given date

    Parameters
    ----------
    some_date: date
        Some date

    Returns
    -------
    week_delta: int
        The number of weeks between MAVEN arrival and a given date

    Examples
    -------
    #>>> date.today()
    2020-06-30
    #>>> mi.get_science_week(date.today())
    294
    """
    # This is the date MAVEN arrived at Mars (week 0 started)
    ref_date = date(2014, 11, 11)

    # Get the number of days between arrival and the given date, and convert to weeks
    week_delta = (some_date - ref_date).days//7
    return week_delta


def get_science_week_range(some_date):
    """ Get the starting date and ending date of a science week

    Parameters
    ----------
    some_date: date
        Some date

    Returns
    -------
    start_date: datetime
        The starting date of the science week
    end_date: datetime
        The ending date of the science week

    Examples
    -------
    #>>> today = date(2020, 1, 1)
    #>>> start_date, end_date = get_science_week_range(today)
    #>>> start_date
    2019-12-31
    #>>> end_date
    2020-01-06
    """
    # Note that Monday = 0, ..., Sunday = 6
    day_number = some_date.weekday()
    if not day_number:
        day_number = 7

    start_date = some_date - timedelta(days=day_number - 1)
    end_date = start_date + timedelta(days=6)
    start_date = datetime(start_date.year, start_date.month, start_date.day, 0, 0, 0)
    end_date = datetime(end_date.year, end_date.month, end_date.day, 23, 59, 59)
    return start_date, end_date
